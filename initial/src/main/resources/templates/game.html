<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style>
div.container {
    width: 100%;
    border: 1px solid gray;
}
div.imgcont {
    width:600px;
	height:400px;
    border: 1px solid gray;
}
header {
    padding: 1em;
    color: white;
    background-color: black;
    clear: left;
    text-align: center;
}
footer {
    padding: 0em;
    color: white;
    background-color: black;
    clear: left;
    text-align: center;
}
nav {
    float: left;
    max-width: 150px;
    margin: 0;
    padding: 1em;
}
nav ul {
    list-style-type: none;
    padding: 0;
}
   
nav ul2{
    text-decoration: none;
}
nav ul a {
    text-decoration: none;
}
article {
    margin-left: 170px;
    border-left: 1px solid gray;
    padding: 1em;
    overflow: hidden;
}
#logout {
	float: right;
}
.game-stats {
	display: inline;
}
</style>
</head>
<body>
<div class="container">

<header>
   <h1>Create a New Tele<font style="color: yellow">strations</font> Game!</h1>
	<form method="GET" th:action="@{/logout}">
		<button id="logout" type="submit">log out</button>
	</form>
</header>
<nav>
  <ul>

  </ul>
</nav>
<article>
	<h1>Ok let's look at this!</h1>
	<p>
		Game:<div th:text="${game.name}"></div>
		Length:<div th:text="${game.length}"></div>
		Length:<div th:="${game.length}"></div>
		Current Place:<div th:text="${game.currLength}"></div>
	</p>

	<div align="left">
		<form th:action="@{/userjoining}">
			<input type="hidden" name="username" th:value="${username}" />
			<input type="hidden" name="gameid" th:value="${game.id}" />
                        <button type="submit" name="submit" value="value" class="link-button">Join game!</button>
                </form>
        </div>	
	
  	<div class="imgcont" id="paint">
		<canvas id="myCanvas" style="border:1px solid #000000;">
			Your browser does not support the HTML5 canvas tag.
		</canvas>
	</div>
	<div class="imgcont" id="paint">
		<canvas id="myCanvas2" style="border:1px solid #000000;">
			Your browser does not support the HTML5 canvas tag.
		</canvas>
	</div>
	
    <script>
		var canvas = document.getElementById('myCanvas');
		var ctx = canvas.getContext('2d');
		 
		var painting = document.getElementById('paint');
		var paint_style = getComputedStyle(painting);
		canvas.width = parseInt(paint_style.getPropertyValue('width'));
		canvas.height = parseInt(paint_style.getPropertyValue('height'));
		
		
		var mouse = {x: 0, y: 0};
		 
		canvas.addEventListener('mousemove', function(e) {
		  mouse.x = e.pageX - this.offsetLeft;
		  mouse.y = e.pageY - this.offsetTop;
		}, false);

		ctx.lineWidth = 5;
		ctx.lineJoin = 'round';
		ctx.lineCap = 'round';
		ctx.strokeStyle = '#000000';
		 
		canvas.addEventListener('mousedown', function(e) {
			ctx.beginPath();
			ctx.moveTo(mouse.x, mouse.y);
		 
			canvas.addEventListener('mousemove', onPaint, false);
		}, false);
		 
		canvas.addEventListener('mouseup', function() {
			canvas.removeEventListener('mousemove', onPaint, false);
		}, false);
		 
		var onPaint = function() {
			ctx.lineTo(mouse.x, mouse.y);
			ctx.stroke();
		};
	    
	    		
		var destinationCanvas = document.getElementById('myCanvas2');

		destinationCanvas.width = parseInt(paint_style.getPropertyValue('width'));
		destinationCanvas.height = parseInt(paint_style.getPropertyValue('height'));
	
		//get the destination context
		destinationCtx = destinationCanvas.getContext('2d');
		
		function saveImg() { 

			var image, destinationCtx;

			//create the image
			image = new Image();

			//get the base64 data
			image.src = canvas.toDataURL('image/png');
			var imgData = image.src;
			
			document.getElementById("imgData").innerHTML = imgData.toString();
			
			//get the destination context
			destinationCtx = destinationCanvas.getContext('2d');

			//copy the data
			destinationCtx.drawImage(image, 0, 0);
			
			
			alert(imgData);
		}
    </script>
	<p id="imgData"></p>
	
	<p>
		<div align="left">
			<form th:action="@{/game}" method="POST">
				<input type="hidden" name="username" th:value="${username}" /> 
				<input type="hidden" name="gameId" th:value="${game.id}" />
				<input type="hidden" name="imgData" th:value="imgData" />
				<input id="saveimg" type="button" value="Submit" onclick="saveImg();" />
			</form>
		</div>
		
		
		<div align="right">
 			<form th:action="@{/mainPage}">
				<input type="hidden" name="username" th:value="${username}" />
				<button type="submit" name="submit" value="value" class="link-button">or go back to homepage</button>
       		</form>
		</div>
	</p>
	
	<br/>
	<br/>
	
	<!--<img src="crayon-outline.png">-->
	<!--<img src="${pageContext.request.contextPath}/crayon-outline.png"/>-->
	<!--<img th:src="@{crayon-outline.png}"/>-->
	
	
	
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
	<br/>
</article>
<footer>therealZADS</footer>

</div>
</body>
</html>
